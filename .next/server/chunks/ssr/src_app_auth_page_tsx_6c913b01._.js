module.exports=[98253,a=>{"use strict";var b=a.i(87924),c=a.i(71987),d=a.i(50944),e=a.i(72131),f=a.i(10849);function g(){let a=(0,d.useRouter)(),[g,h]=(0,e.useState)("login"),[i,j]=(0,e.useState)(""),[k,l]=(0,e.useState)(""),[m,n]=(0,e.useState)(""),[o,p]=(0,e.useState)(""),[q,r]=(0,e.useState)(null),[s,t]=(0,e.useState)(""),[u,v]=(0,e.useState)(""),[w,x]=(0,e.useState)(null),[y,z]=(0,e.useState)(null),A=(0,f.isSupabaseEnabled)();async function B(){if(!A)return void x("Supabase auth is not configured.");let a=i.trim().toLowerCase();if(!a)return void x("Enter your email first, then request a reset link.");let b=(0,f.createClient)();if(!b)return void x("Supabase auth client is unavailable.");z("recover"),x(null);try{let{error:c}=await b.auth.resetPasswordForEmail(a,{redirectTo:`${window.location.origin}/auth/reset`});if(c)return void x(c.message);x("Password reset link sent. Check your inbox.")}finally{z(null)}}async function C(){if(!A)return void x("Supabase auth is not configured.");let a=i.trim().toLowerCase();if(!a)return void x("Enter your email first to resend verification.");let b=(0,f.createClient)();if(!b)return void x("Supabase auth client is unavailable.");z("resend"),x(null);try{let{error:c}=await b.auth.resend({type:"signup",email:a});if(c)return void x(c.message);x("Verification email resent.")}finally{z(null)}}async function D(b){if(b.preventDefault(),!A)return void x("Supabase auth is not configured.");let c=i.trim().toLowerCase();if(!c||!s)return void x("Email and password are required.");if("register"===g){if(!k.trim())return void x("Company name is required.");if(q){if(!q.type.toLowerCase().startsWith("image/"))return void x("Company logo must be an image file.");if(q.size>5242880)return void x("Company logo is too large. Max size is 5MB.")}if(s.length<8)return void x("Password must be at least 8 characters.");if(s!==u)return void x("Password confirmation does not match.")}let d=(0,f.createClient)();if(!d)return void x("Supabase auth client is unavailable.");z("submit"),x(null);try{if("register"===g){let{data:b,error:e}=await d.auth.signUp({email:c,password:s});if(e)return void x(e.message);let f=new FormData;f.set("companyName",k.trim()),m.trim()&&f.set("companySlug",m.trim()),o.trim()&&f.set("companyDescription",o.trim()),f.set("ownerEmail",c),q&&f.set("companyLogo",q);let g={};b.session?.access_token&&(g.Authorization=`Bearer ${b.session.access_token}`);let i=await fetch("/api/ev/crm/projects/auto",{method:"POST",headers:g,body:f});if(!i.ok){let a=await i.json().catch(()=>({}));x(a.error??"Account created, but CRM setup failed. Please contact support.");return}if(b.session)return void a.replace("/dashboard");x("Account created. Check your email to verify, then sign in. Your CRM portal is ready."),h("login"),l(""),n(""),p(""),r(null),t(""),v("");return}let{error:b}=await d.auth.signInWithPassword({email:c,password:s});if(b)return void x(b.message);a.replace("/dashboard")}finally{z(null)}}return(0,e.useEffect)(()=>{if(!A)return;let b=(0,f.createClient)();if(!b)return;let c=!0;b.auth.getSession().then(({data:b})=>{c&&b.session&&(a.refresh(),a.replace("/dashboard"))});let{data:d}=b.auth.onAuthStateChange((b,c)=>{c&&(a.refresh(),a.replace("/dashboard"))});return()=>{c=!1,d.subscription.unsubscribe()}},[a,A]),(0,b.jsxs)("div",{className:"authRoot",children:[(0,b.jsx)("div",{className:"authGlow authGlowA","aria-hidden":!0}),(0,b.jsx)("div",{className:"authGlow authGlowB","aria-hidden":!0}),(0,b.jsx)("div",{className:"authShell authShellSingle",children:(0,b.jsxs)("section",{className:"card authSinglePanel",children:[(0,b.jsxs)("header",{className:"authSingleHeader",children:[(0,b.jsxs)("div",{className:"authSingleBrand",children:[(0,b.jsx)("div",{className:"authBrandBadge",children:(0,b.jsx)(c.default,{src:"https://eburon.ai/icon-eburon.svg",alt:"Eburon Voice",width:36,height:36})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"authEyebrow",children:"Eburon Voice"}),(0,b.jsx)("h1",{className:"authSingleTitle",children:"CSR Admin Console"})]})]}),(0,b.jsx)("p",{className:"authSingleSubtitle",children:"Secure access for operations teams managing voice agents, call routing, and client CRM workspaces."})]}),(0,b.jsxs)("div",{className:"authModeTabs",role:"tablist","aria-label":"Auth mode",children:["login"===g?(0,b.jsx)("button",{type:"button",className:"authModeButton active",onClick:()=>{h("login"),x(null)},role:"tab","aria-selected":"true",children:"Login"}):(0,b.jsx)("button",{type:"button",className:"authModeButton",onClick:()=>{h("login"),x(null)},role:"tab","aria-selected":"false",children:"Login"}),"register"===g?(0,b.jsx)("button",{type:"button",className:"authModeButton active",onClick:()=>{h("register"),x(null)},role:"tab","aria-selected":"true",children:"Register"}):(0,b.jsx)("button",{type:"button",className:"authModeButton",onClick:()=>{h("register"),x(null)},role:"tab","aria-selected":"false",children:"Register"})]}),(0,b.jsx)("h2",{className:"authFormTitle",children:"login"===g?"Welcome back":"Create your account"}),(0,b.jsx)("p",{className:"muted authFormCopy",children:"login"===g?"Sign in with your Eburon Voice email credentials.":"Register with your work email to access the Eburon Voice dashboard."}),A?(0,b.jsxs)("form",{className:"authForm",onSubmit:a=>void D(a),children:[(0,b.jsxs)("label",{children:["Work Email",(0,b.jsx)("input",{type:"email",autoComplete:"email",id:"email",name:"email",value:i,onChange:a=>j(a.target.value),placeholder:"name@company.com",required:!0})]}),"register"===g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("label",{children:["Company Name",(0,b.jsx)("input",{type:"text",autoComplete:"organization",id:"companyName",name:"companyName",value:k,onChange:a=>l(a.target.value),placeholder:"Acme Corporation",required:!0})]}),(0,b.jsxs)("label",{children:["Company Slug (optional)",(0,b.jsx)("input",{type:"text",id:"companySlug",name:"companySlug",value:m,onChange:a=>n(a.target.value),placeholder:"acme-corp"})]}),(0,b.jsxs)("label",{children:["Company Description (optional)",(0,b.jsx)("textarea",{id:"companyDescription",name:"companyDescription",rows:3,value:o,onChange:a=>p(a.target.value),placeholder:"Brief description of your company and CRM use."})]}),(0,b.jsxs)("label",{children:["Company Logo (optional)",(0,b.jsx)("input",{type:"file",id:"companyLogo",name:"companyLogo",accept:"image/*",onChange:a=>r(a.target.files?.[0]??null)})]})]}):null,(0,b.jsxs)("label",{children:["Password","login"===g?(0,b.jsx)("input",{type:"password",id:"password-login",name:"password",autoComplete:"current-password",value:s,onChange:a=>t(a.target.value),placeholder:"Your password",required:!0}):(0,b.jsx)("input",{type:"password",id:"password-register",name:"password",autoComplete:"new-password",value:s,onChange:a=>t(a.target.value),placeholder:"At least 8 characters",required:!0})]}),"register"===g?(0,b.jsxs)("label",{children:["Confirm Password",(0,b.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",value:u,onChange:a=>v(a.target.value),placeholder:"Re-enter password",required:!0})]}):null,(0,b.jsx)("button",{type:"submit",disabled:null!==y,children:"submit"===y?"Submitting...":"login"===g?"Login to Eburon Voice":"Register Account"}),(0,b.jsx)("div",{className:"authAuxActions",children:"login"===g?(0,b.jsx)("button",{type:"button",className:"ghost authAuxButton",onClick:()=>void B(),disabled:null!==y,children:"recover"===y?"Sending reset link...":"Forgot password?"}):(0,b.jsx)("button",{type:"button",className:"ghost authAuxButton",onClick:()=>void C(),disabled:null!==y,children:"resend"===y?"Resending...":"Resend verification email"})})]}):(0,b.jsx)("p",{className:"muted",children:"Supabase auth is not configured. Add `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY` in your environment."}),w?(0,b.jsx)("p",{className:"muted authStatus",children:w}):null]})})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=src_app_auth_page_tsx_6c913b01._.js.map