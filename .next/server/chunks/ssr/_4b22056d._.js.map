{"version":3,"sources":["../../../../src/lib/client/api.ts","../../../../src/components/agent-builder.tsx"],"sourcesContent":["export async function apiRequest<T>(url: string, init?: RequestInit): Promise<T> {\n  const response = await fetch(url, {\n    ...init,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...(init?.headers ?? {}),\n    },\n  });\n\n  const text = await response.text();\n  const payload = text ? safeJsonParse(text) : null;\n\n  if (!response.ok) {\n    const errorMessage =\n      typeof payload === \"object\" && payload && \"error\" in payload\n        ? String((payload as { error: string }).error)\n        : `Request failed (${response.status})`;\n    const details =\n      typeof payload === \"object\" && payload && \"details\" in payload\n        ? (payload as { details?: unknown }).details\n        : undefined;\n    const detailsMessage = getErrorDetailsMessage(details);\n    throw new Error(detailsMessage ? `${errorMessage}: ${detailsMessage}` : errorMessage);\n  }\n\n  return payload as T;\n}\n\nfunction safeJsonParse(text: string): unknown {\n  try {\n    return JSON.parse(text) as unknown;\n  } catch {\n    return text;\n  }\n}\n\nfunction getErrorDetailsMessage(details: unknown): string | null {\n  if (typeof details === \"string\" && details.trim().length > 0) {\n    return details.trim();\n  }\n\n  if (Array.isArray(details)) {\n    const firstString = details.find(\n      (item): item is string => typeof item === \"string\" && item.trim().length > 0,\n    );\n    if (firstString) {\n      return firstString.trim();\n    }\n  }\n\n  if (typeof details !== \"object\" || details === null) {\n    return null;\n  }\n\n  const message = (details as { message?: unknown }).message;\n  if (typeof message === \"string\" && message.trim().length > 0) {\n    return message.trim();\n  }\n\n  if (Array.isArray(message)) {\n    const firstString = message.find(\n      (item): item is string => typeof item === \"string\" && item.trim().length > 0,\n    );\n    if (firstString) {\n      return firstString.trim();\n    }\n  }\n\n  return null;\n}\n","\"use client\";\n\nimport { useEffect, useMemo, useRef, useState } from \"react\";\n\nimport { apiRequest } from \"@/lib/client/api\";\n\ntype VoiceOption = {\n  id: string;\n  label: string;\n  locale: string;\n  previewSampleUrl?: string | null;\n};\n\ntype AgentResponse = {\n  agent: {\n    id: string;\n    name: string;\n    intro: string;\n    firstMessageMode: \"assistant-speaks-first\" | \"assistant-waits-for-user\";\n    systemPrompt: string;\n    voiceId: string;\n    status: \"draft\" | \"deployed\";\n    remoteAgentId?: string | null;\n  };\n};\n\ntype SessionConfig = {\n  assistantId: string;\n  publicKey: string;\n  previewSessionId: string;\n  timeoutSeconds: number;\n};\n\ntype TranscriptItem = {\n  role: \"agent\" | \"user\";\n  text: string;\n  at: string;\n};\n\ntype CallState = \"idle\" | \"connecting\" | \"live\" | \"ended\" | \"error\";\n\nconst hardLimits = {\n  name: 80,\n  intro: 500,\n  prompt: 5000,\n};\n\nconst steps = [\"Identity\", \"Behavior\", \"Voice\"];\n\nfunction extractTranscript(message: unknown): TranscriptItem | null {\n  if (!message || typeof message !== \"object\") {\n    return null;\n  }\n\n  const data = message as Record<string, unknown>;\n  const type = typeof data.type === \"string\" ? data.type : \"\";\n\n  const maybeText =\n    (typeof data.transcript === \"string\" && data.transcript) ||\n    (typeof data.text === \"string\" && data.text) ||\n    (typeof data.message === \"string\" && data.message) ||\n    (typeof data.content === \"string\" && data.content);\n\n  if (!maybeText) {\n    return null;\n  }\n\n  if (!type.includes(\"transcript\") && type !== \"message\") {\n    return null;\n  }\n\n  const role =\n    data.role === \"assistant\" || data.source === \"assistant\" || data.speaker === \"assistant\"\n      ? \"agent\"\n      : \"user\";\n\n  return {\n    role,\n    text: maybeText,\n    at: new Date().toISOString(),\n  };\n}\n\nexport function AgentBuilder() {\n  const [step, setStep] = useState(0);\n  const [voices, setVoices] = useState<VoiceOption[]>([]);\n  const [draftId, setDraftId] = useState<string | null>(null);\n  const [statusText, setStatusText] = useState(\"Fill all required fields to unlock preview.\");\n  const [saving, setSaving] = useState(false);\n  const [deploying, setDeploying] = useState(false);\n  const [calling, setCalling] = useState(false);\n  const [callState, setCallState] = useState<CallState>(\"idle\");\n  const [previewSessionId, setPreviewSessionId] = useState<string | null>(null);\n  const [transcript, setTranscript] = useState<TranscriptItem[]>([]);\n\n  const [form, setForm] = useState({\n    name: \"\",\n    intro: \"\",\n    firstMessageMode: \"assistant-speaks-first\" as \"assistant-speaks-first\" | \"assistant-waits-for-user\",\n    systemPrompt: \"\",\n    voiceId: \"\",\n  });\n\n  const vapiRef = useRef<{ stop: () => void } | null>(null);\n  const timeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  useEffect(() => {\n    let mounted = true;\n    apiRequest<{ voices: VoiceOption[] }>(\"/api/ev/voice/voices\")\n      .then((payload) => {\n        if (!mounted) {\n          return;\n        }\n        setVoices(payload.voices);\n        setForm((prev) => ({ ...prev, voiceId: prev.voiceId || payload.voices[0]?.id || \"\" }));\n      })\n      .catch((error) => {\n        if (mounted) {\n          setStatusText(error.message);\n        }\n      });\n\n    return () => {\n      mounted = false;\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n      vapiRef.current?.stop();\n    };\n  }, []);\n\n  const validation = useMemo(() => {\n    const errors: string[] = [];\n    if (form.name.trim().length < 2 || form.name.trim().length > hardLimits.name) {\n      errors.push(`Agent Name must be 2-${hardLimits.name} characters.`);\n    }\n    if (form.intro.trim().length < 4 || form.intro.trim().length > hardLimits.intro) {\n      errors.push(`Intro / First Message must be 4-${hardLimits.intro} characters.`);\n    }\n    if (form.systemPrompt.trim().length < 20 || form.systemPrompt.trim().length > hardLimits.prompt) {\n      errors.push(`Skills and Description must be 20-${hardLimits.prompt} characters.`);\n    }\n    return errors;\n  }, [form]);\n\n  const ready = validation.length === 0;\n\n  async function syncDraft(): Promise<string> {\n    if (!ready) {\n      throw new Error(\"Complete all required fields before saving.\");\n    }\n\n    if (!draftId) {\n      const payload = await apiRequest<AgentResponse>(\"/api/ev/voice/agents\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          ...form,\n          status: \"draft\",\n          autoCreateRemote: true,\n        }),\n      });\n\n      setDraftId(payload.agent.id);\n      return payload.agent.id;\n    }\n\n    await apiRequest<AgentResponse>(`/api/ev/voice/agents/${draftId}`, {\n      method: \"PATCH\",\n      body: JSON.stringify(form),\n    });\n\n    return draftId;\n  }\n\n  async function handleSaveDraft() {\n    setSaving(true);\n    try {\n      const id = await syncDraft();\n      setStatusText(`Draft saved (${id.slice(0, 8)}...).`);\n    } catch (error) {\n      setStatusText((error as Error).message);\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  async function finishPreview(reason: string) {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n      timeoutRef.current = null;\n    }\n\n    vapiRef.current?.stop();\n    vapiRef.current = null;\n    setCalling(false);\n    setCallState(\"ended\");\n\n    if (previewSessionId) {\n      await apiRequest(`/api/ev/voice/preview-sessions/${previewSessionId}`, {\n        method: \"PATCH\",\n        body: JSON.stringify({\n          status: reason,\n          transcript,\n          ended: true,\n        }),\n      }).catch(() => {\n        // do not block UI on telemetry write\n      });\n    }\n  }\n\n  async function handleStartPreview() {\n    if (!ready) {\n      setStatusText(validation[0] ?? \"Complete all required fields first.\");\n      return;\n    }\n\n    setCalling(true);\n    setCallState(\"connecting\");\n    setStatusText(\"Starting preview...\");\n\n    try {\n      const id = await syncDraft();\n      const config = await apiRequest<SessionConfig>(`/api/ev/voice/session-config?agentId=${id}`);\n\n      setPreviewSessionId(config.previewSessionId);\n      setTranscript([]);\n\n      const mod = await import(\"@vapi-ai/web\");\n      const EburonCtor = mod.default;\n      const client = new EburonCtor(config.publicKey);\n\n      client.on(\"call-start\", () => {\n        setCallState(\"live\");\n        setStatusText(\"Preview call is live.\");\n      });\n\n      client.on(\"call-end\", () => {\n        void finishPreview(\"ended\");\n      });\n\n      client.on(\"message\", (message: unknown) => {\n        const line = extractTranscript(message);\n        if (line) {\n          setTranscript((prev) => [...prev.slice(-99), line]);\n        }\n      });\n\n      client.on(\"error\", (error: unknown) => {\n        setCallState(\"error\");\n        setStatusText(`Preview error: ${String(error)}`);\n      });\n\n      vapiRef.current = client;\n      await client.start(config.assistantId);\n\n      timeoutRef.current = setTimeout(() => {\n        void finishPreview(\"timeout\");\n      }, config.timeoutSeconds * 1000);\n    } catch (error) {\n      setCallState(\"error\");\n      setCalling(false);\n      setStatusText((error as Error).message);\n    }\n  }\n\n  async function handleStopPreview() {\n    await finishPreview(\"stopped\");\n    setStatusText(\"Preview stopped.\");\n  }\n\n  async function handleDeploy() {\n    setDeploying(true);\n    try {\n      const id = await syncDraft();\n      await apiRequest<{ message: string }>(`/api/ev/voice/agents/${id}/deploy`, {\n        method: \"POST\",\n      });\n      setStatusText(\"Agent is live and attached to dashboard routing.\");\n    } catch (error) {\n      setStatusText((error as Error).message);\n    } finally {\n      setDeploying(false);\n    }\n  }\n\n  return (\n    <div className=\"split\">\n      <section className=\"card\">\n        <div className=\"stepTabs\">\n          {steps.map((label, idx) => (\n            <button\n              type=\"button\"\n              key={label}\n              className={`stepTab ${step === idx ? \"active\" : \"\"}`}\n              onClick={() => setStep(idx)}\n            >\n              {idx + 1}. {label}\n            </button>\n          ))}\n        </div>\n\n        {step === 0 && (\n          <div className=\"fieldGrid\">\n            <label>\n              Agent Name\n              <input\n                value={form.name}\n                maxLength={hardLimits.name}\n                onChange={(e) => setForm((prev) => ({ ...prev, name: e.target.value }))}\n                placeholder=\"Weekend Support Desk\"\n              />\n            </label>\n\n            <label>\n              Intro / First Message\n              <textarea\n                rows={4}\n                value={form.intro}\n                maxLength={hardLimits.intro}\n                onChange={(e) => setForm((prev) => ({ ...prev, intro: e.target.value }))}\n                placeholder=\"Hi, you reached Eburon Voice support. How can I help you today?\"\n              />\n            </label>\n\n            <label>\n              Conversation Start\n              <select\n                value={form.firstMessageMode}\n                onChange={(e) =>\n                  setForm((prev) => ({\n                    ...prev,\n                    firstMessageMode: e.target.value as \"assistant-speaks-first\" | \"assistant-waits-for-user\",\n                  }))}\n              >\n                <option value=\"assistant-speaks-first\">Agent speaks first</option>\n                <option value=\"assistant-waits-for-user\">User speaks first</option>\n              </select>\n            </label>\n          </div>\n        )}\n\n        {step === 1 && (\n          <div className=\"fieldGrid\">\n            <label>\n              Skills and Description\n              <textarea\n                rows={10}\n                value={form.systemPrompt}\n                maxLength={hardLimits.prompt}\n                onChange={(e) => setForm((prev) => ({ ...prev, systemPrompt: e.target.value }))}\n                placeholder=\"You are a CSR assistant for Eburon Voice. Keep responses concise, polite, and actionable.\"\n              />\n            </label>\n          </div>\n        )}\n\n        {step === 2 && (\n          <div className=\"fieldGrid\">\n            <label>\n              Voice\n              <select\n                value={form.voiceId}\n                onChange={(e) => setForm((prev) => ({ ...prev, voiceId: e.target.value }))}\n              >\n                {!voices.length && <option value=\"\">Default voice</option>}\n                {voices.map((voice) => (\n                  <option key={voice.id} value={voice.id}>\n                    {voice.label} ({voice.locale})\n                  </option>\n                ))}\n              </select>\n            </label>\n\n            <p className=\"muted\">Only approved voices are shown. If none is selected, a default voice is auto-assigned.</p>\n          </div>\n        )}\n\n        <div className=\"inlineActions templateMarginTopLarge\">\n          <button type=\"button\" className=\"secondary\" onClick={handleSaveDraft} disabled={saving || !ready}>\n            {saving ? \"Saving...\" : \"Save Draft\"}\n          </button>\n          <button type=\"button\" className=\"warn\" onClick={handleStartPreview} disabled={!ready || calling}>\n            {calling ? \"Connecting...\" : \"Preview\"}\n          </button>\n          <button type=\"button\" onClick={handleDeploy} disabled={!ready || deploying}>\n            {deploying ? \"Deploying...\" : \"Deploy\"}\n          </button>\n        </div>\n\n        <p className=\"muted templateMarginTopMedium\">\n          Readiness: {ready ? \"Ready for preview\" : validation[0]}\n        </p>\n      </section>\n\n      <section className=\"phoneMock\">\n        <div className=\"phoneState\">\n          <div>\n            <p className=\"kicker\">Preview Dialer</p>\n            <h3 className=\"templateMarginTopSmall\">Web Call Test</h3>\n          </div>\n          <span className={`badge ${callState === \"live\" ? \"live\" : \"idle\"}`}>{callState}</span>\n        </div>\n\n        <div className=\"inlineActions templateMarginBottomMedium\">\n          <button type=\"button\" className=\"ghost\" onClick={handleStopPreview} disabled={!calling && callState !== \"live\"}>\n            Stop\n          </button>\n        </div>\n\n        <div className=\"transcriptList\">\n          {transcript.length === 0 ? (\n            <p className=\"muted\">Transcript will appear here during the call.</p>\n          ) : (\n            transcript.map((line, idx) => (\n              <div key={`${line.at}-${idx}`} className={`transcriptItem ${line.role === \"user\" ? \"me\" : \"\"}`}>\n                <strong>{line.role === \"agent\" ? \"Agent\" : \"User\"}:</strong> {line.text}\n              </div>\n            ))\n          )}\n        </div>\n\n        <p className=\"muted templateMarginTopMedium\">{statusText}</p>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}