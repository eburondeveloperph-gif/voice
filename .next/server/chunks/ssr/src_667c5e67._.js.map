{"version":3,"sources":["../../../../src/lib/client/api.ts","../../../../src/app/dashboard/page.tsx"],"sourcesContent":["export async function apiRequest<T>(url: string, init?: RequestInit): Promise<T> {\n  const response = await fetch(url, {\n    ...init,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...(init?.headers ?? {}),\n    },\n  });\n\n  const text = await response.text();\n  const payload = text ? safeJsonParse(text) : null;\n\n  if (!response.ok) {\n    const errorMessage =\n      typeof payload === \"object\" && payload && \"error\" in payload\n        ? String((payload as { error: string }).error)\n        : `Request failed (${response.status})`;\n    const details =\n      typeof payload === \"object\" && payload && \"details\" in payload\n        ? (payload as { details?: unknown }).details\n        : undefined;\n    const detailsMessage = getErrorDetailsMessage(details);\n    throw new Error(detailsMessage ? `${errorMessage}: ${detailsMessage}` : errorMessage);\n  }\n\n  return payload as T;\n}\n\nfunction safeJsonParse(text: string): unknown {\n  try {\n    return JSON.parse(text) as unknown;\n  } catch {\n    return text;\n  }\n}\n\nfunction getErrorDetailsMessage(details: unknown): string | null {\n  if (typeof details === \"string\" && details.trim().length > 0) {\n    return details.trim();\n  }\n\n  if (Array.isArray(details)) {\n    const firstString = details.find(\n      (item): item is string => typeof item === \"string\" && item.trim().length > 0,\n    );\n    if (firstString) {\n      return firstString.trim();\n    }\n  }\n\n  if (typeof details !== \"object\" || details === null) {\n    return null;\n  }\n\n  const message = (details as { message?: unknown }).message;\n  if (typeof message === \"string\" && message.trim().length > 0) {\n    return message.trim();\n  }\n\n  if (Array.isArray(message)) {\n    const firstString = message.find(\n      (item): item is string => typeof item === \"string\" && item.trim().length > 0,\n    );\n    if (firstString) {\n      return firstString.trim();\n    }\n  }\n\n  return null;\n}\n","\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\nimport { apiRequest } from \"@/lib/client/api\";\n\ntype OverviewResponse = {\n  org: { name: string };\n  metrics: {\n    agentsCount: number;\n    liveAgentsCount: number;\n    callsCount: number;\n    contactsCount: number;\n    numberCount: number;\n    balanceCents: number;\n  };\n};\n\nexport default function DashboardPage() {\n  const [overview, setOverview] = useState<OverviewResponse | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    apiRequest<OverviewResponse>(\"/api/ev/dashboard/overview\")\n      .then(setOverview)\n      .catch((e: Error) => setError(e.message));\n  }, []);\n\n  return (\n    <div>\n      <header className=\"pageHead\">\n        <div>\n          <h1 className=\"pageTitle\">Dashboard</h1>\n          <p className=\"pageSubtitle\">Overview of live usage and account health.</p>\n        </div>\n      </header>\n\n      {error && <div className=\"card\">{error}</div>}\n\n      <section className=\"sectionGrid\">\n        <article className=\"card metricCard\">\n          <p className=\"kicker\">Org</p>\n          <p className=\"metricValue\">{overview?.org.name ?? \"...\"}</p>\n        </article>\n        <article className=\"card metricCard\">\n          <p className=\"kicker\">Agents</p>\n          <p className=\"metricValue\">{overview?.metrics.agentsCount ?? 0}</p>\n        </article>\n        <article className=\"card metricCard\">\n          <p className=\"kicker\">Live Agents</p>\n          <p className=\"metricValue\">{overview?.metrics.liveAgentsCount ?? 0}</p>\n        </article>\n        <article className=\"card metricCard\">\n          <p className=\"kicker\">Calls Logged</p>\n          <p className=\"metricValue\">{overview?.metrics.callsCount ?? 0}</p>\n        </article>\n        <article className=\"card metricCard\">\n          <p className=\"kicker\">Contacts</p>\n          <p className=\"metricValue\">{overview?.metrics.contactsCount ?? 0}</p>\n        </article>\n        <article className=\"card metricCard\">\n          <p className=\"kicker\">Active Numbers</p>\n          <p className=\"metricValue\">{overview?.metrics.numberCount ?? 0}</p>\n        </article>\n        <article className=\"card metricCard\">\n          <p className=\"kicker\">Billing Balance</p>\n          <p className=\"metricValue\">${((overview?.metrics.balanceCents ?? 0) / 100).toFixed(2)}</p>\n        </article>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}