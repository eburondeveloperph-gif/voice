(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83752,e=>{"use strict";async function t(e,t){let s=await fetch(e,{...t,headers:{"Content-Type":"application/json",...t?.headers??{}}}),l=await s.text(),a=l?function(e){try{return JSON.parse(e)}catch{return e}}(l):null;if(!s.ok){let e="object"==typeof a&&a&&"error"in a?String(a.error):`Request failed (${s.status})`,t=function(e){if("string"==typeof e&&e.trim().length>0)return e.trim();if(Array.isArray(e)){let t=e.find(e=>"string"==typeof e&&e.trim().length>0);if(t)return t.trim()}if("object"!=typeof e||null===e)return null;let t=e.message;if("string"==typeof t&&t.trim().length>0)return t.trim();if(Array.isArray(t)){let e=t.find(e=>"string"==typeof e&&e.trim().length>0);if(e)return e.trim()}return null}("object"==typeof a&&a&&"details"in a?a.details:void 0);throw Error(t?`${e}: ${t}`:e)}return a}e.s(["apiRequest",()=>t])},80710,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(83752);function a(){let[e,a]=(0,s.useState)([]),[i,n]=(0,s.useState)([]),[r,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(""),[o,h]=(0,s.useState)(""),[m,p]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{!async function(){let[e,t]=await Promise.all([(0,l.apiRequest)("/api/ev/voice/agents"),(0,l.apiRequest)("/api/ev/voice/phone-numbers")]);a(e.agents),n(t.numbers),e.agents.length>0&&u(e.agents[0].id),t.numbers.length>0&&h(t.numbers[0].id)}()},[]);let b=async()=>{if(0===r.length)return void f("No jobs to process.");p(!0),f("Starting bulk campaign...");try{let e=await (0,l.apiRequest)("/api/ev/voice/calls/bulk",{method:"POST",body:JSON.stringify({phoneNumberId:o,defaultAssistantId:d,jobs:r})});e.success&&(f(`Bulk campaign completed! Processed ${e.results.length} calls.`),c([]))}catch{f("Campaign error: Unknown error")}finally{p(!1)}};return(0,t.jsxs)("div",{className:"bulkPage",children:[(0,t.jsx)("header",{className:"pageHead",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"pageTitle",children:"Bulk Calls"}),(0,t.jsx)("p",{className:"pageSubtitle",children:"Upload spreadsheets to initiate mass outbound voice campaigns."})]})}),(0,t.jsx)("div",{className:"card bulkCard",children:(0,t.jsxs)("div",{className:"fieldGrid",children:[(0,t.jsxs)("label",{children:["1. Select Default Agent",(0,t.jsx)("select",{value:d,onChange:e=>u(e.target.value),children:e.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,t.jsxs)("label",{children:["2. Select Outbound Line",(0,t.jsx)("select",{value:o,onChange:e=>h(e.target.value),children:i.map(e=>(0,t.jsx)("option",{value:e.id,children:e.displayNumber},e.id))})]}),(0,t.jsxs)("label",{className:"uploadZone",children:["3. Upload CSV File",(0,t.jsx)("input",{type:"file",accept:".csv",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let s=new FileReader;s.onload=e=>{let t=(e.target?.result).split("\n").filter(e=>e.trim()).slice(1).map(e=>{let[t,s,l]=e.split(",").map(e=>e.trim());return{number:t,name:s,assistantId:l}}).filter(e=>e.number);c(t),f(`Detected ${t.length} calls to make.`)},s.readAsText(t)},disabled:m}),(0,t.jsxs)("div",{className:"uploadHint",children:["Header format: ",(0,t.jsx)("code",{children:"number, name, assistantId"})]})]}),r.length>0&&(0,t.jsxs)("div",{className:"previewTable tableWrap",children:[(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Number"}),(0,t.jsx)("th",{children:"Name"}),(0,t.jsx)("th",{children:"Assistant Override"})]})}),(0,t.jsx)("tbody",{children:r.slice(0,5).map((e,s)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.number}),(0,t.jsx)("td",{children:e.name||"-"}),(0,t.jsx)("td",{children:e.assistantId||"Default"})]},s))})]}),r.length>5&&(0,t.jsxs)("p",{className:"muted",children:["... and ",r.length-5," more"]})]}),(0,t.jsx)("button",{type:"button",className:"playBtn bulkBtn",onClick:b,disabled:m||0===r.length,children:m?"âŒ› Processing Bulk Jobs...":`ðŸš€ Start ${r.length} Calls`}),g&&(0,t.jsx)("div",{className:"statusBanner success",children:g})]})})]})}e.s(["default",()=>a])}]);