(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16518,e=>{"use strict";var a=e.i(43476),t=e.i(57688),i=e.i(18566),s=e.i(71645),n=e.i(7471);function r(){let e=(0,i.useRouter)(),[r,o]=(0,s.useState)("login"),[l,u]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),[h,m]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[b,f]=(0,s.useState)(null),[v,y]=(0,s.useState)(""),[x,C]=(0,s.useState)(""),[w,j]=(0,s.useState)(null),[S,N]=(0,s.useState)(null),A=(0,n.isSupabaseEnabled)();async function B(){if(!A)return void j("Supabase auth is not configured.");let e=l.trim().toLowerCase();if(!e)return void j("Enter your email first, then request a reset link.");let a=(0,n.createClient)();if(!a)return void j("Supabase auth client is unavailable.");N("recover"),j(null);try{let{error:t}=await a.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/auth/reset`});if(t)return void j(t.message);j("Password reset link sent. Check your inbox.")}finally{N(null)}}async function E(){if(!A)return void j("Supabase auth is not configured.");let e=l.trim().toLowerCase();if(!e)return void j("Enter your email first to resend verification.");let a=(0,n.createClient)();if(!a)return void j("Supabase auth client is unavailable.");N("resend"),j(null);try{let{error:t}=await a.auth.resend({type:"signup",email:e});if(t)return void j(t.message);j("Verification email resent.")}finally{N(null)}}async function k(a){if(a.preventDefault(),!A)return void j("Supabase auth is not configured.");let t=l.trim().toLowerCase();if(!t||!v)return void j("Email and password are required.");if("register"===r){if(!c.trim())return void j("Company name is required.");if(b){if(!b.type.toLowerCase().startsWith("image/"))return void j("Company logo must be an image file.");if(b.size>5242880)return void j("Company logo is too large. Max size is 5MB.")}if(v.length<8)return void j("Password must be at least 8 characters.");if(v!==x)return void j("Password confirmation does not match.")}let i=(0,n.createClient)();if(!i)return void j("Supabase auth client is unavailable.");N("submit"),j(null);try{if("register"===r){let{data:a,error:s}=await i.auth.signUp({email:t,password:v});if(s)return void j(s.message);let n=new FormData;n.set("companyName",c.trim()),h.trim()&&n.set("companySlug",h.trim()),p.trim()&&n.set("companyDescription",p.trim()),n.set("ownerEmail",t),b&&n.set("companyLogo",b);let r={};a.session?.access_token&&(r.Authorization=`Bearer ${a.session.access_token}`);let l=await fetch("/api/ev/crm/projects/auto",{method:"POST",headers:r,body:n});if(!l.ok){let e=await l.json().catch(()=>({}));j(e.error??"Account created, but CRM setup failed. Please contact support.");return}if(a.session)return void e.replace("/dashboard");j("Account created. Check your email to verify, then sign in. Your CRM portal is ready."),o("login"),d(""),m(""),g(""),f(null),y(""),C("");return}let{error:a}=await i.auth.signInWithPassword({email:t,password:v});if(a)return void j(a.message);e.replace("/dashboard")}finally{N(null)}}return(0,s.useEffect)(()=>{if(!A)return;let a=(0,n.createClient)();if(!a)return;let t=!0;a.auth.getSession().then(({data:a})=>{t&&a.session&&(e.refresh(),e.replace("/dashboard"))});let{data:i}=a.auth.onAuthStateChange((a,t)=>{t&&(e.refresh(),e.replace("/dashboard"))});return()=>{t=!1,i.subscription.unsubscribe()}},[e,A]),(0,a.jsxs)("div",{className:"authRoot",children:[(0,a.jsx)("div",{className:"authGlow authGlowA","aria-hidden":!0}),(0,a.jsx)("div",{className:"authGlow authGlowB","aria-hidden":!0}),(0,a.jsx)("div",{className:"authShell authShellSingle",children:(0,a.jsxs)("section",{className:"card authSinglePanel",children:[(0,a.jsxs)("header",{className:"authSingleHeader",children:[(0,a.jsxs)("div",{className:"authSingleBrand",children:[(0,a.jsx)("div",{className:"authBrandBadge",children:(0,a.jsx)(t.default,{src:"https://eburon.ai/icon-eburon.svg",alt:"Eburon Voice",width:36,height:36})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"authEyebrow",children:"Eburon Voice"}),(0,a.jsx)("h1",{className:"authSingleTitle",children:"CSR Admin Console"})]})]}),(0,a.jsx)("p",{className:"authSingleSubtitle",children:"Secure access for operations teams managing voice agents, call routing, and client CRM workspaces."})]}),(0,a.jsxs)("div",{className:"authModeTabs",role:"tablist","aria-label":"Auth mode",children:["login"===r?(0,a.jsx)("button",{type:"button",className:"authModeButton active",onClick:()=>{o("login"),j(null)},role:"tab","aria-selected":"true",children:"Login"}):(0,a.jsx)("button",{type:"button",className:"authModeButton",onClick:()=>{o("login"),j(null)},role:"tab","aria-selected":"false",children:"Login"}),"register"===r?(0,a.jsx)("button",{type:"button",className:"authModeButton active",onClick:()=>{o("register"),j(null)},role:"tab","aria-selected":"true",children:"Register"}):(0,a.jsx)("button",{type:"button",className:"authModeButton",onClick:()=>{o("register"),j(null)},role:"tab","aria-selected":"false",children:"Register"})]}),(0,a.jsx)("h2",{className:"authFormTitle",children:"login"===r?"Welcome back":"Create your account"}),(0,a.jsx)("p",{className:"muted authFormCopy",children:"login"===r?"Sign in with your Eburon Voice email credentials.":"Register with your work email to access the Eburon Voice dashboard."}),A?(0,a.jsxs)("form",{className:"authForm",onSubmit:e=>void k(e),children:[(0,a.jsxs)("label",{children:["Work Email",(0,a.jsx)("input",{type:"email",autoComplete:"email",id:"email",name:"email",value:l,onChange:e=>u(e.target.value),placeholder:"name@company.com",required:!0})]}),"register"===r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("label",{children:["Company Name",(0,a.jsx)("input",{type:"text",autoComplete:"organization",id:"companyName",name:"companyName",value:c,onChange:e=>d(e.target.value),placeholder:"Acme Corporation",required:!0})]}),(0,a.jsxs)("label",{children:["Company Slug (optional)",(0,a.jsx)("input",{type:"text",id:"companySlug",name:"companySlug",value:h,onChange:e=>m(e.target.value),placeholder:"acme-corp"})]}),(0,a.jsxs)("label",{children:["Company Description (optional)",(0,a.jsx)("textarea",{id:"companyDescription",name:"companyDescription",rows:3,value:p,onChange:e=>g(e.target.value),placeholder:"Brief description of your company and CRM use."})]}),(0,a.jsxs)("label",{children:["Company Logo (optional)",(0,a.jsx)("input",{type:"file",id:"companyLogo",name:"companyLogo",accept:"image/*",onChange:e=>f(e.target.files?.[0]??null)})]})]}):null,(0,a.jsxs)("label",{children:["Password","login"===r?(0,a.jsx)("input",{type:"password",id:"password-login",name:"password",autoComplete:"current-password",value:v,onChange:e=>y(e.target.value),placeholder:"Your password",required:!0}):(0,a.jsx)("input",{type:"password",id:"password-register",name:"password",autoComplete:"new-password",value:v,onChange:e=>y(e.target.value),placeholder:"At least 8 characters",required:!0})]}),"register"===r?(0,a.jsxs)("label",{children:["Confirm Password",(0,a.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",value:x,onChange:e=>C(e.target.value),placeholder:"Re-enter password",required:!0})]}):null,(0,a.jsx)("button",{type:"submit",disabled:null!==S,children:"submit"===S?"Submitting...":"login"===r?"Login to Eburon Voice":"Register Account"}),(0,a.jsx)("div",{className:"authAuxActions",children:"login"===r?(0,a.jsx)("button",{type:"button",className:"ghost authAuxButton",onClick:()=>void B(),disabled:null!==S,children:"recover"===S?"Sending reset link...":"Forgot password?"}):(0,a.jsx)("button",{type:"button",className:"ghost authAuxButton",onClick:()=>void E(),disabled:null!==S,children:"resend"===S?"Resending...":"Resend verification email"})})]}):(0,a.jsx)("p",{className:"muted",children:"Supabase auth is not configured. Add `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY` in your environment."}),w?(0,a.jsx)("p",{className:"muted authStatus",children:w}):null]})})]})}e.s(["default",()=>r])}]);